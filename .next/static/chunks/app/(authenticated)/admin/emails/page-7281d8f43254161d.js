(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5929],{63:(e,r,n)=>{"use strict";var t=n(7260);n.o(t,"redirect")&&n.d(r,{redirect:function(){return t.redirect}}),n.o(t,"usePathname")&&n.d(r,{usePathname:function(){return t.usePathname}}),n.o(t,"useRouter")&&n.d(r,{useRouter:function(){return t.useRouter}}),n.o(t,"useSearchParams")&&n.d(r,{useSearchParams:function(){return t.useSearchParams}})},561:(e,r,n)=>{"use strict";n.r(r),n.d(r,{default:()=>d});var t=n(5155),i=n(2115),o=n(6489),a=n(63),s=n(2619),l=n.n(s);function d(){var e;let{data:r,status:n}=(0,o.useSession)(),s=(0,a.useRouter)(),[d,c]=(0,i.useState)([]),[m,u]=(0,i.useState)([]),[h,g]=(0,i.useState)(""),[f,p]=(0,i.useState)(""),[y,x]=(0,i.useState)(""),[b,j]=(0,i.useState)(!1),[S,v]=(0,i.useState)(null),[w,C]=(0,i.useState)(null),[z,k]=(0,i.useState)(!0);async function R(){try{let e=await fetch("/api/leagues",{credentials:"include",cache:"no-store"}),r=await e.json();c(r.leagues||[]);let n=await fetch("/api/matches?status=SCHEDULED&limit=10",{credentials:"include",cache:"no-store"}),t=await n.json();u(t.matches||[])}catch(e){console.error("Error fetching data:",e)}finally{k(!1)}}async function E(e){j(!0),v(null);try{let r=await fetch("/api/email/send-reminder",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({matchId:e})}),n=await r.json();r.ok?(v("Match reminders sent successfully."),C("success")):(v("Failed to send reminders: ".concat(n.error)),C("error"))}catch(e){v("Error sending reminders."),C("error")}finally{j(!1)}}async function B(){if(!h||!f||!y){v("Please fill in all fields."),C("error");return}j(!0),v(null);try{let e=await fetch("/api/email/send-announcement",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({leagueId:h,subject:f,message:y})}),r=await e.json();e.ok?(v("Announcement sent to ".concat(r.successful," recipients.")),C("success"),p(""),x(""),g("")):(v("Failed to send announcement: ".concat(r.error)),C("error"))}catch(e){v("Error sending announcement."),C("error")}finally{j(!1)}}return((0,i.useEffect)(()=>{var e;if("loading"!==n){if(!(null==r||null==(e=r.user)?void 0:e.isAdmin))return void s.push("/dashboard");R()}},[n,null==r||null==(e=r.user)?void 0:e.isAdmin,s]),z)?(0,t.jsx)("div",{style:{minHeight:"80vh",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,t.jsx)("div",{style:{color:"white"},children:"Loading..."})}):(0,t.jsxs)("div",{style:{minHeight:"80vh"},children:[(0,t.jsx)("div",{style:{backgroundColor:"white",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1)"},children:(0,t.jsx)("div",{style:{maxWidth:"80rem",margin:"0 auto",padding:"1.5rem 1rem"},children:(0,t.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:(0,t.jsxs)("div",{children:[(0,t.jsx)("nav",{style:{display:"flex"},children:(0,t.jsxs)("ol",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,t.jsxs)("li",{children:[(0,t.jsx)(l(),{href:"/admin",style:{color:"#6b7280",textDecoration:"none",fontSize:"0.875rem"},children:"Admin"}),(0,t.jsx)("span",{style:{margin:"0 0.5rem",color:"#9ca3af"},children:"/"})]}),(0,t.jsx)("li",{children:(0,t.jsx)("span",{style:{color:"#111827",fontWeight:"500",fontSize:"0.875rem"},children:"Email Management"})})]})}),(0,t.jsx)("h1",{style:{marginTop:"0.5rem",fontSize:"1.5rem",fontWeight:"bold",color:"#111827",fontFamily:"var(--font-playfair), Georgia, serif"},children:"Email Management"})]})})})}),(0,t.jsxs)("div",{style:{maxWidth:"80rem",margin:"0 auto",padding:"2rem 1rem"},children:[S&&(0,t.jsx)("div",{style:{marginBottom:"1.5rem",padding:"1rem",backgroundColor:"success"===w?"#d1fae5":"#fee2e2",border:"1px solid ".concat("success"===w?"#86efac":"#fecaca"),color:"success"===w?"#065f46":"#991b1b",borderRadius:"0.375rem"},children:S}),(0,t.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(500px, 1fr))",gap:"1.5rem"},children:[(0,t.jsxs)("div",{style:{backgroundColor:"white",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1)",borderRadius:"0.5rem",padding:"1.5rem"},children:[(0,t.jsx)("h2",{style:{fontSize:"1.25rem",fontWeight:"600",marginBottom:"1rem",color:"#111827"},children:"Send League Announcement"}),(0,t.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,t.jsx)("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",color:"#374151",marginBottom:"0.5rem"},children:"Select League"}),(0,t.jsxs)("select",{value:h,onChange:e=>g(e.target.value),style:{width:"100%",padding:"0.5rem",border:"1px solid #d1d5db",borderRadius:"0.375rem",fontSize:"0.875rem"},disabled:b,children:[(0,t.jsx)("option",{value:"",children:"Choose a league"}),d.map(e=>(0,t.jsxs)("option",{value:e.id,children:[e.name," (",e._count.registrations," players)"]},e.id))]})]}),(0,t.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,t.jsx)("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",color:"#374151",marginBottom:"0.5rem"},children:"Subject"}),(0,t.jsx)("input",{type:"text",value:f,onChange:e=>p(e.target.value),placeholder:"Important Update",style:{width:"100%",padding:"0.5rem",border:"1px solid #d1d5db",borderRadius:"0.375rem",fontSize:"0.875rem"},disabled:b})]}),(0,t.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,t.jsx)("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",color:"#374151",marginBottom:"0.5rem"},children:"Message"}),(0,t.jsx)("textarea",{value:y,onChange:e=>x(e.target.value),placeholder:"Enter your announcement message...",rows:6,style:{width:"100%",padding:"0.5rem",border:"1px solid #d1d5db",borderRadius:"0.375rem",fontSize:"0.875rem",resize:"vertical"},disabled:b})]}),(0,t.jsx)("button",{onClick:B,disabled:b||!h||!f||!y,style:{width:"100%",padding:"0.75rem",backgroundColor:b?"#9ca3af":"#3b82f6",color:"white",borderRadius:"0.375rem",fontSize:"0.875rem",fontWeight:"500",border:"none",cursor:b?"not-allowed":"pointer"},children:b?"Sending...":"Send Announcement"})]}),(0,t.jsxs)("div",{style:{backgroundColor:"white",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1)",borderRadius:"0.5rem",padding:"1.5rem"},children:[(0,t.jsx)("h2",{style:{fontSize:"1.25rem",fontWeight:"600",marginBottom:"1rem",color:"#111827"},children:"Send Match Reminders"}),(0,t.jsx)("p",{style:{fontSize:"0.875rem",color:"#6b7280",marginBottom:"1rem"},children:"Send reminder emails to players for upcoming matches"}),(0,t.jsx)("div",{style:{maxHeight:"400px",overflowY:"auto"},children:0===m.length?(0,t.jsx)("p",{style:{color:"#6b7280"},children:"No upcoming matches"}):m.map(e=>(0,t.jsxs)("div",{style:{padding:"1rem",marginBottom:"0.5rem",backgroundColor:"#f9fafb",borderRadius:"0.375rem",border:"1px solid #e5e7eb"},children:[(0,t.jsxs)("div",{style:{fontSize:"0.875rem",marginBottom:"0.5rem"},children:[(0,t.jsx)("strong",{children:e.league.name})," - ",new Date(e.scheduledTime).toLocaleDateString()]}),(0,t.jsxs)("div",{style:{fontSize:"0.875rem",color:"#6b7280",marginBottom:"0.75rem"},children:[e.player1.name," vs ",e.player2.name,e.player3&&" vs ".concat(e.player3.name),e.player4&&" & ".concat(e.player4.name)]}),(0,t.jsx)("button",{onClick:()=>E(e.id),disabled:b,style:{padding:"0.5rem 1rem",backgroundColor:b?"#9ca3af":"#10b981",color:"white",borderRadius:"0.375rem",fontSize:"0.75rem",fontWeight:"500",border:"none",cursor:b?"not-allowed":"pointer"},children:"Send Reminder"})]},e.id))})]})]}),(0,t.jsxs)("div",{style:{marginTop:"2rem",padding:"1rem",backgroundColor:"#dbeafe",border:"1px solid #93c5fd",borderRadius:"0.375rem"},children:[(0,t.jsx)("h3",{style:{fontSize:"1rem",fontWeight:"600",marginBottom:"0.5rem",color:"#1e40af"},children:"Email Configuration"}),(0,t.jsx)("p",{style:{fontSize:"0.875rem",color:"#1e40af"},children:"To enable email sending, configure the following environment variables:"}),(0,t.jsxs)("ul",{style:{marginTop:"0.5rem",marginLeft:"1.5rem",fontSize:"0.875rem",color:"#1e40af"},children:[(0,t.jsx)("li",{children:"EMAIL_HOST (e.g., smtp.gmail.com)"}),(0,t.jsx)("li",{children:"EMAIL_PORT (e.g., 587)"}),(0,t.jsx)("li",{children:"EMAIL_USER (your email address)"}),(0,t.jsx)("li",{children:"EMAIL_PASSWORD (your email password or app-specific password)"})]})]})]})]})}},4098:(e,r,n)=>{Promise.resolve().then(n.bind(n,561))}},e=>{e.O(0,[2619,6489,8441,1255,7358],()=>e(e.s=4098)),_N_E=e.O()}]);