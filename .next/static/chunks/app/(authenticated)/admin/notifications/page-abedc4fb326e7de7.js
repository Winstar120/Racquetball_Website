(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7616],{2971:(e,t,s)=>{Promise.resolve().then(s.bind(s,6304))},6304:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var a=s(5155),i=s(2115),n=s(2619),r=s.n(n);function l(){let[e,t]=(0,i.useState)([]),[s,n]=(0,i.useState)(!1),[l,d]=(0,i.useState)(!1),[c,x]=(0,i.useState)("1"),[m,o]=(0,i.useState)(""),[h,p]=(0,i.useState)("");async function u(){n(!0),p(""),o("");try{let e=await fetch("/api/admin/notifications?daysAhead=".concat(c));if(!e.ok)throw Error("Failed to fetch matches");let s=await e.json();t(s.matches||[]),0===s.matches.length&&o("No matches scheduled in the selected time range.")}catch(e){p("Failed to load matches")}finally{n(!1)}}async function y(){if(confirm("Are you sure you want to send notifications for ".concat(e.length," matches?"))){d(!0),p(""),o("");try{let e=await fetch("/api/admin/notifications",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({daysAhead:parseInt(c)})});if(!e.ok)throw Error("Failed to send notifications");let s=await e.json();o("".concat(s.message,". ").concat(s.successCount," emails sent successfully, ").concat(s.failureCount," failed.")),t([])}catch(e){p("Failed to send notifications")}finally{d(!1)}}}return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("div",{className:"bg-white shadow",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"py-6",children:[(0,a.jsx)("nav",{className:"flex","aria-label":"Breadcrumb",children:(0,a.jsxs)("ol",{className:"flex items-center",children:[(0,a.jsx)("li",{children:(0,a.jsxs)(r(),{href:"/admin",className:"text-gray-500 hover:text-gray-700",children:["Admin",(0,a.jsx)("span",{className:"mx-2 text-gray-400",children:"/"})]})}),(0,a.jsx)("li",{children:(0,a.jsx)("span",{className:"text-gray-900 font-medium",children:"Match Notifications"})})]})}),(0,a.jsx)("h1",{className:"mt-2 text-2xl font-bold text-gray-900",children:"Send Match Reminders"})]})})}),(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,a.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h2",{className:"text-lg font-medium mb-4",children:"Email Notification Settings"}),(0,a.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-4 mb-4",children:(0,a.jsxs)("p",{className:"text-sm text-blue-800",children:[(0,a.jsx)("strong",{children:"Note:"})," Match reminders include opponent contact information (name, email, and phone number) to allow players to coordinate directly."]})}),(0,a.jsxs)("div",{className:"flex items-end gap-4",children:[(0,a.jsxs)("div",{className:"flex-1 max-w-xs",children:[(0,a.jsx)("label",{htmlFor:"daysAhead",className:"block text-sm font-medium text-gray-700 mb-1",children:"Send reminders for matches within"}),(0,a.jsxs)("select",{id:"daysAhead",value:c,onChange:e=>x(e.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",children:[(0,a.jsx)("option",{value:"1",children:"Next 24 hours"}),(0,a.jsx)("option",{value:"2",children:"Next 2 days"}),(0,a.jsx)("option",{value:"3",children:"Next 3 days"}),(0,a.jsx)("option",{value:"7",children:"Next week"})]})]}),(0,a.jsx)("button",{onClick:u,disabled:s,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 disabled:opacity-50",children:s?"Loading...":"Preview Matches"})]})]}),m&&(0,a.jsx)("div",{className:"mb-4 rounded-md bg-green-50 p-4 text-green-800",children:m}),h&&(0,a.jsx)("div",{className:"mb-4 rounded-md bg-red-50 p-4 text-red-800",children:h}),e.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsxs)("h3",{className:"text-lg font-medium",children:[e.length," Upcoming Matches"]}),(0,a.jsx)("button",{onClick:y,disabled:l,className:"px-4 py-2 text-sm font-medium text-white bg-green-600 border border-transparent rounded-md hover:bg-green-700 disabled:opacity-50",children:l?"Sending...":"Send ".concat(2*e.length," Reminders")})]}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date/Time"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"League"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Court"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Player 1"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Player 2"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email Status"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(e=>{var t;return(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:new Date(e.scheduledTime).toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:e.league.name}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:(null==(t=e.court)?void 0:t.name)||"TBD"}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-gray-900",children:e.player1.name}),(0,a.jsx)("div",{className:"text-gray-500 text-xs",children:e.player1.email})]})}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-gray-900",children:e.player2.name}),(0,a.jsx)("div",{className:"text-gray-500 text-xs",children:e.player2.email})]})}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ".concat(e.player1.emailNotifications?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:["P1: ",e.player1.emailNotifications?"Yes":"No"]}),(0,a.jsx)("br",{}),(0,a.jsxs)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ".concat(e.player2.emailNotifications?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:["P2: ",e.player2.emailNotifications?"Yes":"No"]})]})})]},e.id)})})]})}),(0,a.jsxs)("div",{className:"mt-4 text-sm text-gray-600",children:[(0,a.jsx)("p",{children:"* Reminders will only be sent to players who have email notifications enabled."}),(0,a.jsx)("p",{children:"* Each player receives their opponent's contact information (name, email, and phone number)."})]})]})]})})]})}}},e=>{e.O(0,[2619,8441,1255,7358],()=>e(e.s=2971)),_N_E=e.O()}]);