(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4953],{4921:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>a});var l=t(5155),n=t(2115),o=t(2619),i=t.n(o);function a(e){let r,{params:t}=e,[o,a]=(0,n.useState)(null),[d,s]=(0,n.useState)({kind:"loading"}),[c,h]=(0,n.useState)(!1),[m,u]=(0,n.useState)(!1),[g,p]=(0,n.useState)(null),f=(0,n.useCallback)(async e=>{let r=null!=e?e:o;if(r){s({kind:"loading"});try{var t,l,n,i,a;let e=await fetch("/api/admin/leagues/".concat(r,"/schedule"),{credentials:"include"});if(!e.ok)throw Error("Failed to load schedule");let o=await e.json(),d=o.isGenerated&&o.matches.length>0?o.matches[0]:!o.isGenerated&&o.preview.scheduledMatches.length>0?o.preview.scheduledMatches[0]:void 0,c=null!=(a=null!=(i=null==d||null==(t=d.league)?void 0:t.name)?i:null==d||null==(n=d.player1)||null==(l=n.league)?void 0:l.name)?a:"League";o.isGenerated?s({kind:"generated",matches:o.matches,totals:{totalMatches:o.totalMatches,totalWeeks:o.totalWeeks,makeupMatches:o.makeupMatches},leagueName:c}):s({kind:"preview",data:o.preview,leagueName:c}),p(null)}catch(e){s({kind:"error",message:e instanceof Error?e.message:"Failed to load schedule"})}}},[o]);async function x(){if(o){h(!0),p(null);try{await f(o),p("Preview reshuffled. Review the matchups and click Save Schedule when satisfied.")}finally{h(!1)}}}async function y(){if(o){u(!0),p(null);try{let r=await fetch("/api/admin/leagues/".concat(o,"/schedule"),{method:"POST",credentials:"include"});if(!r.ok){var e;let t=await r.json().catch(()=>({})),l=null!=(e=null==t?void 0:t.error)?e:"Failed to generate schedule";throw Error(l)}await f(),p("Schedule saved. Matches are now available in Admin → Matches.")}catch(e){s({kind:"error",message:e instanceof Error?e.message:"Failed to generate schedule"})}finally{u(!1)}}}(0,n.useEffect)(()=>{let e=!0;return t.then(r=>{e&&(a(r.leagueId),f(r.leagueId))}),()=>{e=!1}},[f,t]);let b=(0,l.jsx)("div",{style:{backgroundColor:"white",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1)"},children:(0,l.jsxs)("div",{style:{maxWidth:"80rem",margin:"0 auto",padding:"1.5rem 1rem"},children:[(0,l.jsx)("nav",{style:{display:"flex"},"aria-label":"Breadcrumb",children:(0,l.jsxs)("ol",{style:{display:"flex",alignItems:"center",gap:"0.5rem",margin:0,padding:0,listStyle:"none"},children:[(0,l.jsxs)("li",{children:[(0,l.jsx)(i(),{href:"/admin/leagues",style:{color:"#6b7280",textDecoration:"none",fontSize:"0.875rem"},children:"Leagues"}),(0,l.jsx)("span",{style:{margin:"0 0.5rem",color:"#9ca3af"},children:"/"})]}),(0,l.jsx)("li",{children:(0,l.jsx)("span",{style:{color:"#111827",fontWeight:500,fontSize:"0.875rem"},children:"Schedule"})})]})}),(0,l.jsxs)("h1",{style:{marginTop:"0.75rem",fontSize:"1.75rem",fontWeight:"bold",color:"#111827",fontFamily:"var(--font-playfair), Georgia, serif"},children:["generated"===d.kind||"preview"===d.kind?d.leagueName:"League"," Schedule"]}),(0,l.jsx)("p",{style:{marginTop:"0.25rem",color:"#6b7280",fontSize:"0.95rem"},children:"Automatically build the match calendar using available court slots. Once generated, matches will appear under Admin → Matches."})]})});function j(e,r){return(0,l.jsxs)("div",{style:{backgroundColor:"white",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)"},children:[(0,l.jsx)("div",{style:{padding:"1.5rem 1.5rem 0"},children:(0,l.jsx)("h2",{style:{fontSize:"1.1rem",fontWeight:600,color:"#111827"},children:r})}),(0,l.jsx)("div",{style:{overflowX:"auto",padding:"1.5rem"},children:(0,l.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{style:{backgroundColor:"#f9fafb",color:"#6b7280",fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.05em"},children:[(0,l.jsx)("th",{style:{padding:"0.75rem 1rem",textAlign:"left"},children:"Date"}),(0,l.jsx)("th",{style:{padding:"0.75rem 1rem",textAlign:"left"},children:"Time"}),(0,l.jsx)("th",{style:{padding:"0.75rem 1rem",textAlign:"left"},children:"Players"}),(0,l.jsx)("th",{style:{padding:"0.75rem 1rem",textAlign:"left"},children:"Court"}),(0,l.jsx)("th",{style:{padding:"0.75rem 1rem",textAlign:"left"},children:"Week"}),(0,l.jsx)("th",{style:{padding:"0.75rem 1rem",textAlign:"left"},children:"Status"})]})}),(0,l.jsx)("tbody",{children:e.map((e,r)=>{var t,n,o,i,a,d,s,c,h;let{date:m,time:u}=function(e){let r=new Date(e);return{date:r.toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"}),time:r.toLocaleTimeString(void 0,{hour:"numeric",minute:"2-digit"})}}(e.scheduledTime),g=null!=(t=e.status)?t:e.isMakeup?"MAKEUP":e.id?"Scheduled":"Projected";return(0,l.jsxs)("tr",{style:{borderTop:0===r?"none":"1px solid #e5e7eb"},children:[(0,l.jsx)("td",{style:{padding:"1rem",fontSize:"0.95rem",color:"#111827"},children:m}),(0,l.jsx)("td",{style:{padding:"1rem",fontSize:"0.95rem",color:"#374151"},children:u}),(0,l.jsx)("td",{style:{padding:"1rem",fontSize:"0.95rem",color:"#111827"},children:[null!=(s=null==(o=e.player1)?void 0:o.name)?s:"Player 1",null!=(c=null==(i=e.player2)?void 0:i.name)?c:"Player 2",null==(a=e.player3)?void 0:a.name,null==(d=e.player4)?void 0:d.name].filter(Boolean).join(" vs ")}),(0,l.jsx)("td",{style:{padding:"1rem",fontSize:"0.9rem",color:"#374151"},children:(null==(h=e.court)?void 0:h.name)?e.court.location?"".concat(e.court.name," \xb7 ").concat(e.court.location):e.court.name:e.courtNumber?"Court ".concat(e.courtNumber):"TBD"}),(0,l.jsx)("td",{style:{padding:"1rem",fontSize:"0.9rem",color:"#374151"},children:null!=(n=e.weekNumber)?n:"—"}),(0,l.jsx)("td",{style:{padding:"1rem",fontSize:"0.85rem",color:"#374151"},children:(0,l.jsx)("span",{style:{display:"inline-block",padding:"0.25rem 0.6rem",borderRadius:"9999px",fontSize:"0.75rem",fontWeight:500,backgroundColor:"#f3f4f6",color:"COMPLETED"===g?"#065f46":"MAKEUP"===g?"#92400e":"#374151"},children:g.replace("_"," ")})})]},"".concat(e.player1Id,"-").concat(e.player2Id,"-").concat(r))})})]})})]})}if("loading"===d.kind)r=(0,l.jsx)("div",{style:{backgroundColor:"white",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",padding:"1.75rem",textAlign:"center"},children:(0,l.jsx)("p",{style:{color:"#6b7280"},children:"Loading schedule…"})});else if("error"===d.kind)r=(0,l.jsxs)("div",{style:{backgroundColor:"white",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",padding:"1.75rem"},children:[(0,l.jsx)("p",{style:{color:"#b91c1c",marginBottom:"1rem"},children:d.message}),(0,l.jsx)("button",{onClick:()=>f(),style:{padding:"0.75rem 1.5rem",fontSize:"0.95rem",fontWeight:600,color:"white",backgroundColor:"#1f2937",border:"1px solid #1f2937",cursor:"pointer"},children:"Retry"})]});else if("preview"===d.kind){let{data:e}=d;r=(0,l.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"2rem"},children:[(0,l.jsxs)("div",{style:{backgroundColor:"white",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",padding:"1.75rem"},children:[(0,l.jsx)("h2",{style:{fontSize:"1.1rem",fontWeight:600,color:"#111827",marginBottom:"1rem"},children:"Preview Summary"}),(0,l.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:"1rem"},children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{style:{fontSize:"0.8rem",color:"#6b7280",marginBottom:"0.25rem"},children:"Projected Games"}),(0,l.jsx)("p",{style:{fontSize:"1.5rem",fontWeight:600,color:"#111827"},children:e.projectedGames})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{style:{fontSize:"0.8rem",color:"#6b7280",marginBottom:"0.25rem"},children:"Total Weeks"}),(0,l.jsx)("p",{style:{fontSize:"1.5rem",fontWeight:600,color:"#111827"},children:e.totalWeeks})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{style:{fontSize:"0.8rem",color:"#6b7280",marginBottom:"0.25rem"},children:"Scheduled Matches"}),(0,l.jsx)("p",{style:{fontSize:"1.5rem",fontWeight:600,color:"#111827"},children:e.scheduledMatches.length})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{style:{fontSize:"0.8rem",color:"#6b7280",marginBottom:"0.25rem"},children:"Makeup Matches"}),(0,l.jsx)("p",{style:{fontSize:"1.5rem",fontWeight:600,color:"#111827"},children:e.makeupMatches.length})]})]}),g&&(0,l.jsx)("p",{style:{marginTop:"0.75rem",color:"#2563eb",fontSize:"0.9rem"},children:g}),(0,l.jsxs)("div",{style:{marginTop:"1.5rem",display:"flex",gap:"0.75rem",flexWrap:"wrap"},children:[(0,l.jsx)("button",{onClick:x,disabled:c||m,style:{padding:"0.75rem 1.5rem",fontSize:"0.95rem",fontWeight:600,color:"white",backgroundColor:c||m?"#4b5563":"#1f2937",border:"1px solid "+(c||m?"#4b5563":"#1f2937"),cursor:c||m?"not-allowed":"pointer",opacity:c||m?.75:1,transition:"all 0.2s"},children:c?"Shuffling…":"Shuffle Preview"}),(0,l.jsx)("button",{onClick:y,disabled:m,style:{padding:"0.75rem 1.75rem",fontSize:"0.95rem",fontWeight:600,color:"white",backgroundColor:m?"#4b5563":"#2563eb",border:"1px solid "+(m?"#4b5563":"#2563eb"),cursor:m?"not-allowed":"pointer",opacity:m?.75:1,transition:"all 0.2s"},children:m?"Saving…":"Save Schedule"}),(0,l.jsx)(i(),{href:"/admin/matches",style:{display:"inline-flex",alignItems:"center",justifyContent:"center",padding:"0.75rem 1.5rem",fontSize:"0.95rem",fontWeight:500,color:"#1f2937",backgroundColor:"white",border:"1px solid #d1d5db",textDecoration:"none",transition:"all 0.2s"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#f3f4f6",e.currentTarget.style.borderColor="#9ca3af"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="white",e.currentTarget.style.borderColor="#d1d5db"},children:"Manage Matches"})]})]}),j(e.scheduledMatches,"Projected Matches"),e.makeupMatches.length>0&&j(e.makeupMatches,"Potential Makeup Matches")]})}else r=(0,l.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[(0,l.jsxs)("div",{style:{backgroundColor:"white",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",padding:"1.75rem"},children:[(0,l.jsx)("h2",{style:{fontSize:"1.1rem",fontWeight:600,color:"#111827",marginBottom:"1rem"},children:"Schedule Generated"}),(0,l.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:"1rem"},children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{style:{fontSize:"0.8rem",color:"#6b7280",marginBottom:"0.25rem"},children:"Total Matches"}),(0,l.jsx)("p",{style:{fontSize:"1.5rem",fontWeight:600,color:"#111827"},children:d.totals.totalMatches})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{style:{fontSize:"0.8rem",color:"#6b7280",marginBottom:"0.25rem"},children:"Total Weeks"}),(0,l.jsx)("p",{style:{fontSize:"1.5rem",fontWeight:600,color:"#111827"},children:d.totals.totalWeeks})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{style:{fontSize:"0.8rem",color:"#6b7280",marginBottom:"0.25rem"},children:"Makeup Matches"}),(0,l.jsx)("p",{style:{fontSize:"1.5rem",fontWeight:600,color:"#111827"},children:d.totals.makeupMatches})]})]}),(0,l.jsx)("p",{style:{marginTop:"1rem",color:"#6b7280",fontSize:"0.9rem"},children:"Matches are now available on the Admin → Matches page for further adjustments, court changes, or manual overrides."}),g&&(0,l.jsx)("p",{style:{marginTop:"0.75rem",color:"#2563eb",fontSize:"0.9rem"},children:g}),(0,l.jsx)(i(),{href:"/admin/matches",style:{display:"inline-flex",alignItems:"center",justifyContent:"center",marginTop:"1rem",padding:"0.75rem 1.5rem",fontSize:"0.95rem",fontWeight:500,color:"#1f2937",backgroundColor:"white",border:"1px solid #d1d5db",textDecoration:"none",transition:"all 0.2s"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#f3f4f6",e.currentTarget.style.borderColor="#9ca3af"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="white",e.currentTarget.style.borderColor="#d1d5db"},children:"Go to Matches"})]}),j(d.matches,"Scheduled Matches")]});return(0,l.jsxs)("div",{style:{minHeight:"calc(100vh - 64px)"},children:[b,(0,l.jsx)("div",{style:{maxWidth:"80rem",margin:"0 auto",padding:"2rem 1rem"},children:r})]})}},8986:(e,r,t)=>{Promise.resolve().then(t.bind(t,4921))}},e=>{e.O(0,[2619,8441,1255,7358],()=>e(e.s=8986)),_N_E=e.O()}]);