(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1682],{2877:(e,r,i)=>{Promise.resolve().then(i.bind(i,5742))},5742:(e,r,i)=>{"use strict";i.r(r),i.d(r,{default:()=>a});var t=i(5155),l=i(2115),n=i(2619),o=i.n(n);let s={width:"100%",padding:"0.65rem 0.75rem",border:"1px solid #d1d5db",fontSize:"1rem",color:"#111827",outline:"none",backgroundColor:"white"};function d(e){return e?{}:{onFocus:e=>{e.currentTarget.style.borderColor="#111827",e.currentTarget.style.boxShadow="0 0 0 1px #111827"},onBlur:e=>{e.currentTarget.style.borderColor="#d1d5db",e.currentTarget.style.boxShadow="none"}}}function a(e){let r,{params:i}=e,[n,a]=(0,l.useState)(null),[c,m]=(0,l.useState)({kind:"loading"}),[g,h]=(0,l.useState)(""),[u,x]=(0,l.useState)([]),[p,f]=(0,l.useState)(!1),[y,b]=(0,l.useState)(""),[j,v]=(0,l.useState)(null),[S,w]=(0,l.useState)(null),[k,C]=(0,l.useState)(null),[z,T]=(0,l.useState)(null);async function W(e){m({kind:"loading"}),w(null),v(null);try{var r,i;let t=await fetch("/api/admin/leagues/".concat(e,"/registrations"),{credentials:"include",cache:"no-store"});if(!t.ok)throw Error("Failed to load registrations");let l=await t.json(),n=null!=(i=null==(r=l.league.divisions[0])?void 0:r.id)?i:"";b(e=>e||n),m({kind:"ready",league:l.league,registrations:l.registrations})}catch(e){m({kind:"error",message:e instanceof Error?e.message:"Failed to load registrations"})}}(0,l.useEffect)(()=>{let e=!0;return i.then(r=>{e&&a(r.leagueId)}),()=>{e=!1}},[i]),(0,l.useEffect)(()=>{n&&W(n)},[n]);let E=(0,l.useMemo)(()=>"ready"!==c.kind?new Set:new Set(c.registrations.map(e=>e.user.id)),[c]);async function A(){w(null),v(null),f(!0);try{let e=g.trim(),r=e?"/api/admin/users?search=".concat(encodeURIComponent(e)):"/api/admin/users",i=await fetch(r,{credentials:"include"});if(!i.ok)throw Error("Search failed");let t=((await i.json()).users||[]).filter(e=>!E.has(e.id)).map(e=>({id:e.id,name:e.name,email:e.email,skillLevel:e.skillLevel}));x(t),0===t.length?v(e?"No matching users found or all are already registered.":"All users are already registered for this league."):v(null)}catch(e){w(e instanceof Error?e.message:"Search failed"),x([])}finally{f(!1)}}async function L(e){if(!y)return void w("Select a division before adding a player.");if(n){C(e),w(null),v(null);try{let i=await fetch("/api/admin/leagues/".concat(n,"/registrations"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({userId:e,divisionId:y})});if(!i.ok){var r;let e=null!=(r=(await i.json().catch(()=>({}))).error)?r:"Failed to add registration";throw Error(e)}let t=await i.json();"ready"===c.kind&&m({kind:"ready",league:c.league,registrations:[t.registration,...c.registrations]}),x(r=>r.filter(r=>r.id!==e)),v("Player successfully added to the league.")}catch(e){w(e instanceof Error?e.message:"Failed to add registration")}finally{C(null)}}}async function B(e){if(confirm("Remove this player from the league?")&&n){T(e),w(null),v(null);try{let i=await fetch("/api/admin/leagues/".concat(n,"/registrations?registrationId=").concat(e),{method:"DELETE",credentials:"include"});if(!i.ok){var r;let e=null!=(r=(await i.json().catch(()=>({}))).error)?r:"Failed to remove registration";throw Error(e)}"ready"===c.kind&&m({kind:"ready",league:c.league,registrations:c.registrations.filter(r=>r.id!==e)}),v("Player removed from the league.")}catch(e){w(e instanceof Error?e.message:"Failed to remove registration")}finally{T(null)}}}let F=(0,t.jsx)("div",{style:{backgroundColor:"white",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1)"},children:(0,t.jsxs)("div",{style:{maxWidth:"80rem",margin:"0 auto",padding:"1.5rem 1rem"},children:[(0,t.jsx)("nav",{style:{display:"flex"},"aria-label":"Breadcrumb",children:(0,t.jsxs)("ol",{style:{display:"flex",alignItems:"center",gap:"0.5rem",margin:0,padding:0,listStyle:"none"},children:[(0,t.jsxs)("li",{children:[(0,t.jsx)(o(),{href:"/admin/leagues",style:{color:"#6b7280",textDecoration:"none",fontSize:"0.875rem"},children:"Leagues"}),(0,t.jsx)("span",{style:{margin:"0 0.5rem",color:"#9ca3af"},children:"/"})]}),(0,t.jsx)("li",{children:(0,t.jsx)("span",{style:{color:"#111827",fontWeight:500,fontSize:"0.875rem"},children:"Registrations"})})]})}),(0,t.jsxs)("h1",{style:{marginTop:"0.75rem",fontSize:"1.75rem",fontWeight:"bold",color:"#111827",fontFamily:"var(--font-playfair), Georgia, serif"},children:["ready"===c.kind?c.league.name:"League"," Registrations"]}),(0,t.jsx)("p",{style:{marginTop:"0.25rem",color:"#6b7280",fontSize:"0.95rem"},children:"Add or remove players from this league. New players must be registered users in the system."})]})});if("loading"===c.kind)r=(0,t.jsx)("div",{style:{backgroundColor:"white",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",padding:"1.75rem",textAlign:"center"},children:(0,t.jsx)("p",{style:{color:"#6b7280"},children:"Loading registrations…"})});else if("error"===c.kind)r=(0,t.jsxs)("div",{style:{backgroundColor:"white",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",padding:"1.75rem"},children:[(0,t.jsx)("p",{style:{color:"#b91c1c",marginBottom:"1rem"},children:c.message}),(0,t.jsx)("button",{onClick:()=>n&&W(n),style:{padding:"0.75rem 1.5rem",fontSize:"0.95rem",fontWeight:600,color:"white",backgroundColor:"#1f2937",border:"1px solid #1f2937",cursor:"pointer"},children:"Retry"})]});else{let{league:e,registrations:i}=c;r=(0,t.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"2rem"},children:[(0,t.jsxs)("div",{style:{backgroundColor:"white",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",padding:"1.75rem"},children:[(0,t.jsx)("h2",{style:{fontSize:"1.1rem",fontWeight:600,color:"#111827",marginBottom:"1rem"},children:"Overview"}),(0,t.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))",gap:"1rem"},children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{style:{fontSize:"0.8rem",color:"#6b7280",marginBottom:"0.25rem"},children:"Total Players"}),(0,t.jsx)("p",{style:{fontSize:"1.5rem",fontWeight:600,color:"#111827"},children:i.length})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{style:{fontSize:"0.8rem",color:"#6b7280",marginBottom:"0.25rem"},children:"Divisions"}),(0,t.jsx)("p",{style:{fontSize:"1.5rem",fontWeight:600,color:"#111827"},children:e.divisions.length})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{style:{fontSize:"0.8rem",color:"#6b7280",marginBottom:"0.25rem"},children:"League Type"}),(0,t.jsx)("p",{style:{fontSize:"1.5rem",fontWeight:600,color:"#111827"},children:e.isFree?"Free":"Paid"})]})]})]}),(0,t.jsxs)("div",{style:{backgroundColor:"white",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",padding:"1.75rem"},children:[(0,t.jsx)("h2",{style:{fontSize:"1.1rem",fontWeight:600,color:"#111827",marginBottom:"1rem"},children:"Add Player"}),0===e.divisions.length?(0,t.jsx)("p",{style:{color:"#b91c1c"},children:"This league does not have any divisions configured. Add divisions before registering players."}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(240px, 1fr))",gap:"1rem",marginBottom:"1rem"},children:[(0,t.jsx)("input",{type:"text",placeholder:"Search by name or email",value:g,onChange:e=>h(e.target.value),disabled:p,style:s,...d(p)}),(0,t.jsx)("select",{value:y,onChange:e=>b(e.target.value),disabled:p,style:s,...d(p),children:e.divisions.map(e=>(0,t.jsxs)("option",{value:e.id,children:[e.name," (",e.level,")"]},e.id))}),(0,t.jsx)("button",{onClick:A,disabled:p,style:{padding:"0.75rem 1.5rem",fontSize:"0.95rem",fontWeight:600,color:"white",backgroundColor:p?"#4b5563":"#1f2937",border:"1px solid "+(p?"#4b5563":"#1f2937"),cursor:p?"not-allowed":"pointer",transition:"all 0.2s"},children:p?"Searching…":"Search Users"})]}),j&&(0,t.jsx)("p",{style:{color:"#047857",marginBottom:"1rem"},children:j}),S&&(0,t.jsx)("p",{style:{color:"#b91c1c",marginBottom:"1rem"},children:S}),u.length>0&&(0,t.jsxs)("div",{style:{marginTop:"1rem",border:"1px solid #e5e7eb",padding:"1rem",backgroundColor:"#f9fafb"},children:[(0,t.jsx)("h3",{style:{fontSize:"1rem",fontWeight:600,color:"#111827",marginBottom:"0.75rem"},children:"Search Results"}),(0,t.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:u.map(e=>(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",backgroundColor:"white",border:"1px solid #e5e7eb",padding:"0.75rem 1rem"},children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{style:{fontSize:"0.95rem",fontWeight:600,color:"#111827"},children:e.name}),(0,t.jsx)("div",{style:{fontSize:"0.85rem",color:"#6b7280"},children:e.email}),e.skillLevel&&(0,t.jsxs)("div",{style:{fontSize:"0.85rem",color:"#6b7280"},children:["Skill Level: ",e.skillLevel]})]}),(0,t.jsx)("button",{onClick:()=>L(e.id),disabled:k===e.id,style:{padding:"0.6rem 1.25rem",fontSize:"0.9rem",fontWeight:600,color:"white",backgroundColor:k===e.id?"#4b5563":"#1f2937",border:"1px solid "+(k===e.id?"#4b5563":"#1f2937"),cursor:k===e.id?"not-allowed":"pointer",transition:"all 0.2s"},children:k===e.id?"Adding…":"Add to League"})]},e.id))})]})]})]}),(0,t.jsxs)("div",{style:{backgroundColor:"white",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)"},children:[(0,t.jsx)("div",{style:{padding:"1.5rem 1.5rem 0"},children:(0,t.jsx)("h2",{style:{fontSize:"1.1rem",fontWeight:600,color:"#111827"},children:"Current Registrations"})}),(0,t.jsx)("div",{style:{overflowX:"auto",padding:"1.5rem"},children:0===i.length?(0,t.jsx)("p",{style:{color:"#6b7280"},children:"No players registered yet."}):(0,t.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse"},children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{style:{backgroundColor:"#f9fafb",color:"#6b7280",fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.05em"},children:[(0,t.jsx)("th",{style:{padding:"0.75rem 1rem",textAlign:"left"},children:"Player"}),(0,t.jsx)("th",{style:{padding:"0.75rem 1rem",textAlign:"left"},children:"Division"}),(0,t.jsx)("th",{style:{padding:"0.75rem 1rem",textAlign:"left"},children:"Contact"}),(0,t.jsx)("th",{style:{padding:"0.75rem 1rem",textAlign:"left"},children:"Skill"}),(0,t.jsx)("th",{style:{padding:"0.75rem 1rem",textAlign:"left"},children:"Registered"}),(0,t.jsx)("th",{style:{padding:"0.75rem 1rem",textAlign:"left"},children:"Payment"}),(0,t.jsx)("th",{style:{padding:"0.75rem 1rem",textAlign:"left"},children:"Actions"})]})}),(0,t.jsx)("tbody",{children:i.map((e,r)=>{let i=new Date(e.registrationDate).toLocaleDateString();return(0,t.jsxs)("tr",{style:{borderTop:0===r?"none":"1px solid #e5e7eb"},children:[(0,t.jsxs)("td",{style:{padding:"1rem",fontSize:"0.95rem",color:"#111827"},children:[(0,t.jsx)("div",{style:{fontWeight:600},children:e.user.name}),(0,t.jsx)("div",{style:{fontSize:"0.85rem",color:"#6b7280"},children:e.user.email})]}),(0,t.jsx)("td",{style:{padding:"1rem",fontSize:"0.9rem",color:"#374151"},children:e.division?"".concat(e.division.name," (").concat(e.division.level,")"):"—"}),(0,t.jsx)("td",{style:{padding:"1rem",fontSize:"0.85rem",color:"#374151"},children:e.user.phone||"—"}),(0,t.jsx)("td",{style:{padding:"1rem",fontSize:"0.85rem",color:"#374151"},children:e.user.skillLevel||"Unrated"}),(0,t.jsx)("td",{style:{padding:"1rem",fontSize:"0.85rem",color:"#374151"},children:i}),(0,t.jsx)("td",{style:{padding:"1rem",fontSize:"0.85rem",color:"#374151"},children:e.paymentStatus}),(0,t.jsx)("td",{style:{padding:"1rem"},children:(0,t.jsx)("button",{onClick:()=>B(e.id),disabled:z===e.id,style:{padding:"0.5rem 1rem",fontSize:"0.85rem",fontWeight:500,color:"#b91c1c",backgroundColor:"white",border:"1px solid #fca5a5",cursor:z===e.id?"not-allowed":"pointer",opacity:z===e.id?.75:1},children:z===e.id?"Removing…":"Remove"})})]},e.id)})})]})})]})]})}return(0,t.jsxs)("div",{style:{minHeight:"calc(100vh - 64px)"},children:[F,(0,t.jsx)("div",{style:{maxWidth:"80rem",margin:"0 auto",padding:"2rem 1rem"},children:r})]})}}},e=>{e.O(0,[2619,8441,1255,7358],()=>e(e.s=2877)),_N_E=e.O()}]);