(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7755],{63:(e,t,r)=>{"use strict";var n=r(7260);r.o(n,"redirect")&&r.d(t,{redirect:function(){return n.redirect}}),r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}}),r.o(n,"useSearchParams")&&r.d(t,{useSearchParams:function(){return n.useSearchParams}})},4131:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>g});var n=r(5155),i=r(2115),o=r(63),a=r(2619),l=r.n(a);let s={width:"100%",padding:"0.65rem 0.75rem",border:"1px solid #d1d5db",fontSize:"1rem",color:"#111827",outline:"none",backgroundColor:"white"};function d(e){return e?{}:{onFocus:e=>{e.currentTarget.style.borderColor="#111827",e.currentTarget.style.boxShadow="0 0 0 1px #111827"},onBlur:e=>{e.currentTarget.style.borderColor="#d1d5db",e.currentTarget.style.boxShadow="none"}}}function c(e){if(!e)return"";let t=new Date(e);return Number.isNaN(t.getTime())?"":t.toISOString().slice(0,10)}function g(e){let t,{params:r}=e,a=(0,o.useRouter)(),[g,u]=(0,i.useState)(null),[m,h]=(0,i.useState)({kind:"loading"}),[p,y]=(0,i.useState)({name:"",description:"",gameType:"SINGLES",rankingMethod:"BY_WINS",pointsToWin:"11",winByTwo:"true",matchDuration:"45",startDate:"",endDate:"",registrationOpens:"",registrationCloses:"",isFree:"true",leagueFee:"0"}),[x,f]=(0,i.useState)(!1),[b,j]=(0,i.useState)(!1),[v,S]=(0,i.useState)(null),[w,C]=(0,i.useState)(null);async function T(e){h({kind:"loading"}),C(null),S(null);try{var t,r,n,i,o;let a=await fetch("/api/admin/leagues/".concat(e),{credentials:"include"});if(!a.ok)throw Error("Failed to load league");let l=(await a.json()).league;y({name:null!=(t=l.name)?t:"",description:null!=(r=l.description)?r:"",gameType:l.gameType,rankingMethod:l.rankingMethod,pointsToWin:String(null!=(n=l.pointsToWin)?n:11),winByTwo:l.winByTwo?"true":"false",matchDuration:String(null!=(i=l.matchDuration)?i:45),startDate:c(l.startDate),endDate:c(l.endDate),registrationOpens:c(l.registrationOpens),registrationCloses:c(l.registrationCloses),isFree:l.isFree?"true":"false",leagueFee:String(null!=(o=l.leagueFee)?o:0)}),h({kind:"ready",league:l})}catch(e){h({kind:"error",message:e instanceof Error?e.message:"Failed to load league"})}}function k(e,t){y(r=>"isFree"===e?{...r,isFree:t,leagueFee:"true"===t?"0":r.leagueFee}:{...r,[e]:t})}async function F(e){if(e.preventDefault(),"ready"===m.kind&&g){f(!0),S(null),C(null);try{var t,r,n,i,o,a;let e={name:p.name,description:p.description,rankingMethod:p.rankingMethod,gameType:p.gameType,pointsToWin:Number(p.pointsToWin),winByTwo:"true"===p.winByTwo,matchDuration:Number(p.matchDuration),startDate:p.startDate,endDate:p.endDate,registrationOpens:p.registrationOpens,registrationCloses:p.registrationCloses,isFree:"true"===p.isFree,leagueFee:Number(p.leagueFee)},l=await fetch("/api/admin/leagues/".concat(g),{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(!l.ok){let e=null!=(t=(await l.json().catch(()=>({}))).error)?t:"Failed to update league";throw Error(e)}let s=await l.json();S("League updated successfully.");let d=s.league;y({name:null!=(r=d.name)?r:"",description:null!=(n=d.description)?n:"",gameType:d.gameType,rankingMethod:d.rankingMethod,pointsToWin:String(null!=(i=d.pointsToWin)?i:11),winByTwo:d.winByTwo?"true":"false",matchDuration:String(null!=(o=d.matchDuration)?o:45),startDate:c(d.startDate),endDate:c(d.endDate),registrationOpens:c(d.registrationOpens),registrationCloses:c(d.registrationCloses),isFree:d.isFree?"true":"false",leagueFee:String(null!=(a=d.leagueFee)?a:0)}),h({kind:"ready",league:s.league})}catch(e){C(e instanceof Error?e.message:"Failed to update league")}finally{f(!1)}}}async function D(){if(confirm("Deleting this league will remove all matches, registrations, and divisions. This action cannot be undone. Do you want to continue?")&&g){j(!0),S(null),C(null);try{let t=await fetch("/api/admin/leagues/".concat(g),{method:"DELETE",credentials:"include"});if(!t.ok){var e;let r=null!=(e=(await t.json().catch(()=>({}))).error)?e:"Failed to delete league";throw Error(r)}a.push("/admin/leagues"),a.refresh()}catch(e){C(e instanceof Error?e.message:"Failed to delete league")}finally{j(!1)}}}(0,i.useEffect)(()=>{let e=!0;return r.then(t=>{e&&u(t.leagueId)}),()=>{e=!1}},[r]),(0,i.useEffect)(()=>{g&&T(g)},[g]);let W=(0,n.jsx)("div",{style:{backgroundColor:"white",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1)"},children:(0,n.jsxs)("div",{style:{maxWidth:"80rem",margin:"0 auto",padding:"1.5rem 1rem"},children:[(0,n.jsx)("nav",{style:{display:"flex"},"aria-label":"Breadcrumb",children:(0,n.jsxs)("ol",{style:{display:"flex",alignItems:"center",gap:"0.5rem",margin:0,padding:0,listStyle:"none"},children:[(0,n.jsxs)("li",{children:[(0,n.jsx)(l(),{href:"/admin/leagues",style:{color:"#6b7280",textDecoration:"none",fontSize:"0.875rem"},children:"Leagues"}),(0,n.jsx)("span",{style:{margin:"0 0.5rem",color:"#9ca3af"},children:"/"})]}),(0,n.jsx)("li",{children:(0,n.jsx)("span",{style:{color:"#111827",fontWeight:500,fontSize:"0.875rem"},children:"Edit"})})]})}),(0,n.jsxs)("h1",{style:{marginTop:"0.75rem",fontSize:"1.75rem",fontWeight:"bold",color:"#111827",fontFamily:"var(--font-playfair), Georgia, serif"},children:["ready"===m.kind?m.league.name:"League"," Settings"]}),(0,n.jsx)("p",{style:{marginTop:"0.25rem",color:"#6b7280",fontSize:"0.95rem"},children:"Update basic league configuration or retire the league entirely."})]})});if("loading"===m.kind)t=(0,n.jsx)("div",{style:{backgroundColor:"white",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",padding:"1.75rem",textAlign:"center"},children:(0,n.jsx)("p",{style:{color:"#6b7280"},children:"Loading league details…"})});else if("error"===m.kind)t=(0,n.jsxs)("div",{style:{backgroundColor:"white",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",padding:"1.75rem"},children:[(0,n.jsx)("p",{style:{color:"#b91c1c",marginBottom:"1rem"},children:m.message}),(0,n.jsx)("button",{onClick:()=>g&&T(g),style:{padding:"0.75rem 1.5rem",fontSize:"0.95rem",fontWeight:600,color:"white",backgroundColor:"#1f2937",border:"1px solid #1f2937",cursor:"pointer"},children:"Retry"})]});else{let e=m.league.scheduleGenerated;t=(0,n.jsxs)("form",{onSubmit:F,style:{display:"flex",flexDirection:"column",gap:"2rem"},children:[w&&(0,n.jsx)("div",{style:{padding:"1rem",backgroundColor:"#fef2f2",border:"1px solid #fecaca",color:"#b91c1c"},children:w}),v&&(0,n.jsx)("div",{style:{padding:"1rem",backgroundColor:"#ecfdf5",border:"1px solid #a7f3d0",color:"#047857"},children:v}),(0,n.jsxs)("section",{style:{backgroundColor:"white",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",padding:"1.75rem"},children:[(0,n.jsx)("h2",{style:{fontSize:"1.1rem",fontWeight:600,color:"#111827",marginBottom:"1rem"},children:"Basic Details"}),(0,n.jsxs)("div",{style:{display:"grid",gap:"1.5rem",gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))"},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"name",style:{display:"block",fontSize:"0.95rem",fontWeight:500,color:"#374151",marginBottom:"0.5rem"},children:"League Name"}),(0,n.jsx)("input",{id:"name",value:p.name,onChange:e=>k("name",e.target.value),style:s,...d(!1)})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"rankingMethod",style:{display:"block",fontSize:"0.95rem",fontWeight:500,color:"#374151",marginBottom:"0.5rem"},children:"Ranking Method"}),(0,n.jsxs)("select",{id:"rankingMethod",value:p.rankingMethod,onChange:e=>k("rankingMethod",e.target.value),style:s,...d(!1),children:[(0,n.jsx)("option",{value:"BY_WINS",children:"By Wins"}),(0,n.jsx)("option",{value:"BY_POINTS",children:"By Total Points"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"gameType",style:{display:"block",fontSize:"0.95rem",fontWeight:500,color:"#374151",marginBottom:"0.5rem"},children:"Game Type"}),(0,n.jsxs)("select",{id:"gameType",value:p.gameType,onChange:e=>k("gameType",e.target.value),disabled:e,style:{...s,backgroundColor:e?"#f9fafb":"white",cursor:e?"not-allowed":"pointer"},...d(e),children:[(0,n.jsx)("option",{value:"SINGLES",children:"Singles"}),(0,n.jsx)("option",{value:"DOUBLES",children:"Doubles"}),(0,n.jsx)("option",{value:"CUTTHROAT",children:"Cut-throat"})]}),e&&(0,n.jsx)("p",{style:{marginTop:"0.35rem",fontSize:"0.85rem",color:"#b91c1c"},children:"Game type cannot be changed after a schedule is generated."})]}),(0,n.jsxs)("div",{style:{gridColumn:"1 / -1"},children:[(0,n.jsx)("label",{htmlFor:"description",style:{display:"block",fontSize:"0.95rem",fontWeight:500,color:"#374151",marginBottom:"0.5rem"},children:"Description"}),(0,n.jsx)("textarea",{id:"description",value:p.description,onChange:e=>k("description",e.target.value),rows:3,style:{...s,resize:"vertical"},...d(!1)})]})]})]}),(0,n.jsxs)("section",{style:{backgroundColor:"white",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",padding:"1.75rem"},children:[(0,n.jsx)("h2",{style:{fontSize:"1.1rem",fontWeight:600,color:"#111827",marginBottom:"1rem"},children:"Scoring & Duration"}),(0,n.jsxs)("div",{style:{display:"grid",gap:"1.5rem",gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))"},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"pointsToWin",style:{display:"block",fontSize:"0.95rem",fontWeight:500,color:"#374151",marginBottom:"0.5rem"},children:"Points to Win"}),(0,n.jsx)("input",{id:"pointsToWin",type:"number",min:"1",value:p.pointsToWin,onChange:e=>k("pointsToWin",e.target.value),style:s,...d(!1)})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"matchDuration",style:{display:"block",fontSize:"0.95rem",fontWeight:500,color:"#374151",marginBottom:"0.5rem"},children:"Match Duration (minutes)"}),(0,n.jsx)("input",{id:"matchDuration",type:"number",min:"1",value:p.matchDuration,onChange:e=>k("matchDuration",e.target.value),style:s,...d(!1)}),(0,n.jsx)("p",{style:{marginTop:"0.35rem",fontSize:"0.85rem",color:"#6b7280"},children:"Includes any built-in warmup time."})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"winByTwo",style:{display:"block",fontSize:"0.95rem",fontWeight:500,color:"#374151",marginBottom:"0.5rem"},children:"Win by Two"}),(0,n.jsxs)("select",{id:"winByTwo",value:p.winByTwo,onChange:e=>k("winByTwo",e.target.value),style:s,...d(!1),children:[(0,n.jsx)("option",{value:"true",children:"Yes"}),(0,n.jsx)("option",{value:"false",children:"No"})]})]})]})]}),(0,n.jsxs)("section",{style:{backgroundColor:"white",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",padding:"1.75rem"},children:[(0,n.jsx)("h2",{style:{fontSize:"1.1rem",fontWeight:600,color:"#111827",marginBottom:"1rem"},children:"Season Dates"}),(0,n.jsxs)("div",{style:{display:"grid",gap:"1.5rem",gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))"},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"startDate",style:{display:"block",fontSize:"0.95rem",fontWeight:500,color:"#374151",marginBottom:"0.5rem"},children:"Season Starts"}),(0,n.jsx)("input",{id:"startDate",type:"date",value:p.startDate,onChange:e=>k("startDate",e.target.value),style:s,...d(!1)})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"endDate",style:{display:"block",fontSize:"0.95rem",fontWeight:500,color:"#374151",marginBottom:"0.5rem"},children:"Season Ends"}),(0,n.jsx)("input",{id:"endDate",type:"date",value:p.endDate,onChange:e=>k("endDate",e.target.value),style:s,...d(!1)})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"registrationOpens",style:{display:"block",fontSize:"0.95rem",fontWeight:500,color:"#374151",marginBottom:"0.5rem"},children:"Registration Opens"}),(0,n.jsx)("input",{id:"registrationOpens",type:"date",value:p.registrationOpens,onChange:e=>k("registrationOpens",e.target.value),style:s,...d(!1)})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"registrationCloses",style:{display:"block",fontSize:"0.95rem",fontWeight:500,color:"#374151",marginBottom:"0.5rem"},children:"Registration Closes"}),(0,n.jsx)("input",{id:"registrationCloses",type:"date",value:p.registrationCloses,onChange:e=>k("registrationCloses",e.target.value),style:s,...d(!1)})]})]})]}),(0,n.jsxs)("section",{style:{backgroundColor:"white",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",padding:"1.75rem"},children:[(0,n.jsx)("h2",{style:{fontSize:"1.1rem",fontWeight:600,color:"#111827",marginBottom:"1rem"},children:"Registration & Fees"}),(0,n.jsxs)("div",{style:{display:"grid",gap:"1.5rem",gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))"},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"isFree",style:{display:"block",fontSize:"0.95rem",fontWeight:500,color:"#374151",marginBottom:"0.5rem"},children:"League Type"}),(0,n.jsxs)("select",{id:"isFree",value:p.isFree,onChange:e=>k("isFree",e.target.value),style:s,...d(!1),children:[(0,n.jsx)("option",{value:"true",children:"Free"}),(0,n.jsx)("option",{value:"false",children:"Paid"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"leagueFee",style:{display:"block",fontSize:"0.95rem",fontWeight:500,color:"#374151",marginBottom:"0.5rem"},children:"League Fee (USD)"}),(0,n.jsx)("input",{id:"leagueFee",type:"number",min:"0",step:"0.01",value:p.leagueFee,onChange:e=>k("leagueFee",e.target.value),disabled:"true"===p.isFree,style:{...s,backgroundColor:"true"===p.isFree?"#f9fafb":"white",cursor:"true"===p.isFree?"not-allowed":"text"},...d("true"===p.isFree)})]})]})]}),(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"0.75rem"},children:[(0,n.jsx)(l(),{href:"/admin/leagues",style:{display:"inline-flex",alignItems:"center",justifyContent:"center",padding:"0.75rem 1.5rem",fontSize:"0.95rem",fontWeight:500,color:"#1f2937",backgroundColor:"white",border:"1px solid #d1d5db",textDecoration:"none",transition:"all 0.2s"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#f3f4f6",e.currentTarget.style.borderColor="#9ca3af"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="white",e.currentTarget.style.borderColor="#d1d5db"},children:"Cancel"}),(0,n.jsx)("button",{type:"submit",disabled:x,style:{padding:"0.75rem 1.75rem",fontSize:"0.95rem",fontWeight:600,color:"white",backgroundColor:x?"#4b5563":"#1f2937",border:"1px solid "+(x?"#4b5563":"#1f2937"),cursor:x?"not-allowed":"pointer",opacity:x?.75:1,transition:"all 0.2s"},children:x?"Saving…":"Save Changes"})]}),(0,n.jsxs)("section",{style:{backgroundColor:"white",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",padding:"1.75rem",border:"1px solid #fecaca"},children:[(0,n.jsx)("h2",{style:{fontSize:"1.1rem",fontWeight:600,color:"#b91c1c",marginBottom:"0.75rem"},children:"Delete League"}),(0,n.jsx)("p",{style:{color:"#6b7280",fontSize:"0.9rem",marginBottom:"1rem"},children:"Removing a league will permanently delete all related matches, registrations, and divisions. This cannot be undone."}),(0,n.jsx)("button",{type:"button",onClick:D,disabled:b,style:{padding:"0.75rem 1.5rem",fontSize:"0.95rem",fontWeight:600,color:"white",backgroundColor:b?"#7f1d1d":"#b91c1c",border:"1px solid "+(b?"#7f1d1d":"#b91c1c"),cursor:b?"not-allowed":"pointer",opacity:b?.75:1,transition:"all 0.2s"},children:b?"Deleting…":"Delete League"})]})]})}return(0,n.jsxs)("div",{style:{minHeight:"calc(100vh - 64px)"},children:[W,(0,n.jsx)("div",{style:{maxWidth:"80rem",margin:"0 auto",padding:"2rem 1rem"},children:t})]})}},7924:(e,t,r)=>{Promise.resolve().then(r.bind(r,4131))}},e=>{e.O(0,[2619,8441,1255,7358],()=>e(e.s=7924)),_N_E=e.O()}]);