(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8370],{1863:(e,t,l)=>{Promise.resolve().then(l.bind(l,3042))},3042:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>c});var i=l(5155),a=l(2115),r=l(2619),o=l.n(r);let n=[{value:0,label:"Sunday"},{value:1,label:"Monday"},{value:2,label:"Tuesday"},{value:3,label:"Wednesday"},{value:4,label:"Thursday"},{value:5,label:"Friday"},{value:6,label:"Saturday"}],s=Array.from({length:96},(e,t)=>{let l=15*t,i=Math.floor(l/60).toString().padStart(2,"0"),a=(l%60).toString().padStart(2,"0");return"".concat(i,":").concat(a)}),d={width:"100%",padding:"0.65rem 0.75rem",border:"1px solid #d1d5db",fontSize:"1rem",color:"#111827",outline:"none",backgroundColor:"white"};function c(){let[e,t]=(0,a.useState)([]),[l,r]=(0,a.useState)([]),[c,m]=(0,a.useState)(!0),[u,h]=(0,a.useState)(!1),[f,y]=(0,a.useState)(null),[p,b]=(0,a.useState)(null),[g,v]=(0,a.useState)({dayOfWeek:"1",startTime:"18:00",endTime:"19:00",courtId:""});async function x(){m(!0),y(null),b(null);try{var e,l;let[i,a]=await Promise.all([fetch("/api/admin/courts/global-availability",{credentials:"include"}),fetch("/api/admin/courts",{credentials:"include"})]);if(!i.ok)throw Error("Failed to load availability");if(!a.ok)throw Error("Failed to load courts");let o=await i.json(),n=await a.json();t(null!=(e=o.availability)?e:[]),r((null!=(l=n.courts)?l:[]).map(e=>({id:e.id,name:e.name,location:e.location})))}catch(e){b(e instanceof Error?e.message:"Failed to load availability")}finally{m(!1)}}(0,a.useEffect)(()=>{x()},[]);let j=(0,a.useMemo)(()=>{let t=new Map;return e.forEach(e=>{t.has(e.dayOfWeek)||t.set(e.dayOfWeek,[]),t.get(e.dayOfWeek).push(e)}),Array.from(t.entries()).sort((e,t)=>e[0]-t[0])},[e]);async function S(e){e.preventDefault(),h(!0),y(null),b(null);try{let e={dayOfWeek:Number(g.dayOfWeek),startTime:g.startTime,endTime:g.endTime,courtId:g.courtId||null};if(e.startTime>=e.endTime)throw Error("End time must be after start time");let l=await fetch("/api/admin/courts/global-availability",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(!l.ok){var t;let e=await l.json().catch(()=>({}));throw Error(null!=(t=e.error)?t:"Failed to create availability")}await x(),y("Availability slot created successfully.")}catch(e){b(e instanceof Error?e.message:"Failed to create availability")}finally{h(!1)}}async function k(e){try{let i=await fetch("/api/admin/courts/global-availability/".concat(e.id),{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({isActive:!e.isActive})});if(!i.ok){var l;let e=await i.json().catch(()=>({}));throw Error(null!=(l=e.error)?l:"Failed to update slot")}t(t=>t.map(t=>t.id===e.id?{...t,isActive:!t.isActive}:t)),y("Availability ".concat(e.isActive?"deactivated":"activated","."))}catch(e){b(e instanceof Error?e.message:"Failed to update slot")}}async function w(e){if(confirm("Remove this availability slot?"))try{let i=await fetch("/api/admin/courts/global-availability/".concat(e),{method:"DELETE",credentials:"include"});if(!i.ok){var l;let e=await i.json().catch(()=>({}));throw Error(null!=(l=e.error)?l:"Failed to delete slot")}t(t=>t.filter(t=>t.id!==e)),y("Availability slot removed.")}catch(e){b(e instanceof Error?e.message:"Failed to delete slot")}}return(0,i.jsxs)("div",{style:{minHeight:"calc(100vh - 64px)"},children:[(0,i.jsx)("div",{style:{backgroundColor:"white",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1)"},children:(0,i.jsxs)("div",{style:{maxWidth:"80rem",margin:"0 auto",padding:"1.5rem 1rem"},children:[(0,i.jsx)("nav",{style:{display:"flex"},"aria-label":"Breadcrumb",children:(0,i.jsxs)("ol",{style:{display:"flex",alignItems:"center",gap:"0.5rem",margin:0,padding:0,listStyle:"none"},children:[(0,i.jsxs)("li",{children:[(0,i.jsx)(o(),{href:"/admin/courts",style:{color:"#6b7280",textDecoration:"none",fontSize:"0.875rem"},children:"Courts"}),(0,i.jsx)("span",{style:{margin:"0 0.5rem",color:"#9ca3af"},children:"/"})]}),(0,i.jsx)("li",{children:(0,i.jsx)("span",{style:{color:"#111827",fontWeight:500,fontSize:"0.875rem"},children:"Global Availability"})})]})}),(0,i.jsx)("h1",{style:{marginTop:"0.75rem",fontSize:"1.75rem",fontWeight:"bold",color:"#111827",fontFamily:"var(--font-playfair), Georgia, serif"},children:"Global Court Availability"}),(0,i.jsx)("p",{style:{marginTop:"0.25rem",color:"#6b7280",fontSize:"0.95rem"},children:"Configure the default time slots used when generating league schedules. Slots apply to all courts unless a specific court is selected."})]})}),(0,i.jsxs)("div",{style:{maxWidth:"80rem",margin:"0 auto",padding:"2rem 1rem",display:"flex",flexDirection:"column",gap:"2rem"},children:[(p||f)&&(0,i.jsx)("div",{style:{padding:"1rem",backgroundColor:p?"#fef2f2":"#ecfdf5",border:"1px solid "+(p?"#fecaca":"#a7f3d0"),color:p?"#b91c1c":"#047857"},children:null!=p?p:f}),(0,i.jsxs)("section",{style:{backgroundColor:"white",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",padding:"1.75rem"},children:[(0,i.jsx)("h2",{style:{fontSize:"1.1rem",fontWeight:600,color:"#111827",marginBottom:"1rem"},children:"Add Availability Slot"}),(0,i.jsxs)("form",{onSubmit:S,style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",alignItems:"end"},children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",fontSize:"0.9rem",color:"#374151",marginBottom:"0.35rem"},children:"Day"}),(0,i.jsx)("select",{value:g.dayOfWeek,onChange:e=>v(t=>({...t,dayOfWeek:e.target.value})),style:d,children:n.map(e=>(0,i.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",fontSize:"0.9rem",color:"#374151",marginBottom:"0.35rem"},children:"Start"}),(0,i.jsx)("select",{value:g.startTime,onChange:e=>v(t=>({...t,startTime:e.target.value})),style:d,children:s.map(e=>(0,i.jsx)("option",{value:e,children:e},e))})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",fontSize:"0.9rem",color:"#374151",marginBottom:"0.35rem"},children:"End"}),(0,i.jsx)("select",{value:g.endTime,onChange:e=>v(t=>({...t,endTime:e.target.value})),style:d,children:s.map(e=>(0,i.jsx)("option",{value:e,children:e},e))})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{style:{display:"block",fontSize:"0.9rem",color:"#374151",marginBottom:"0.35rem"},children:"Court (optional)"}),(0,i.jsxs)("select",{value:g.courtId,onChange:e=>v(t=>({...t,courtId:e.target.value})),style:d,children:[(0,i.jsx)("option",{value:"",children:"Both courts"}),l.map(e=>(0,i.jsx)("option",{value:e.id,children:e.location?"".concat(e.name," \xb7 ").concat(e.location):e.name},e.id))]})]}),(0,i.jsx)("button",{type:"submit",disabled:u,style:{padding:"0.75rem 1.5rem",fontSize:"0.95rem",fontWeight:600,color:"white",backgroundColor:u?"#4b5563":"#1f2937",border:"1px solid "+(u?"#4b5563":"#1f2937"),cursor:u?"not-allowed":"pointer",opacity:u?.75:1,transition:"all 0.2s"},children:u?"Adding…":"Add Slot"})]})]}),(0,i.jsxs)("section",{style:{backgroundColor:"white",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",padding:"1.75rem"},children:[(0,i.jsx)("h2",{style:{fontSize:"1.1rem",fontWeight:600,color:"#111827",marginBottom:"1rem"},children:"Existing Slots"}),c?(0,i.jsx)("p",{style:{color:"#6b7280"},children:"Loading…"}):0===e.length?(0,i.jsx)("p",{style:{color:"#6b7280"},children:"No global availability configured yet."}):(0,i.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"1.25rem"},children:j.map(e=>{var t,l;let[a,r]=e;return(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{style:{fontSize:"1rem",fontWeight:600,color:"#111827",marginBottom:"0.5rem"},children:null!=(l=null==(t=n.find(e=>e.value===a))?void 0:t.label)?l:"Day ".concat(a)}),(0,i.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"0.6rem"},children:r.map(e=>(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",border:"1px solid #e5e7eb",padding:"0.75rem 1rem",backgroundColor:"white"},children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{style:{fontSize:"0.95rem",color:"#111827",fontWeight:500},children:[e.startTime," – ",e.endTime]}),(0,i.jsx)("div",{style:{fontSize:"0.85rem",color:"#6b7280"},children:e.court?e.court.location?"".concat(e.court.name," \xb7 ").concat(e.court.location):e.court.name:"Both courts"})]}),(0,i.jsxs)("div",{style:{display:"flex",gap:"0.5rem"},children:[(0,i.jsx)("button",{onClick:()=>k(e),style:{padding:"0.45rem 0.9rem",fontSize:"0.85rem",fontWeight:500,color:e.isActive?"#047857":"#1f2937",backgroundColor:e.isActive?"#ecfdf5":"#f3f4f6",border:"1px solid "+(e.isActive?"#a7f3d0":"#d1d5db"),cursor:"pointer"},children:e.isActive?"Active":"Activate"}),(0,i.jsx)("button",{onClick:()=>w(e.id),style:{padding:"0.45rem 0.9rem",fontSize:"0.85rem",fontWeight:500,color:"#b91c1c",backgroundColor:"#fef2f2",border:"1px solid #fecaca",cursor:"pointer"},children:"Delete"})]})]},e.id))})]},a)})})]})]})]})}}},e=>{e.O(0,[2619,8441,1255,7358],()=>e(e.s=1863)),_N_E=e.O()}]);