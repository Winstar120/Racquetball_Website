(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[658],{63:(e,r,t)=>{"use strict";var i=t(7260);t.o(i,"redirect")&&t.d(r,{redirect:function(){return i.redirect}}),t.o(i,"usePathname")&&t.d(r,{usePathname:function(){return i.usePathname}}),t.o(i,"useRouter")&&t.d(r,{useRouter:function(){return i.useRouter}}),t.o(i,"useSearchParams")&&t.d(r,{useSearchParams:function(){return i.useSearchParams}})},1566:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>c});var i=t(5155),o=t(2115),n=t(6489),s=t(63),a=t(2619),l=t.n(a),d=t(5016);function c(){let{data:e,status:r}=(0,n.useSession)(),t=(0,s.useRouter)(),[a,c]=(0,o.useState)([]),[u,g]=(0,o.useState)(!0),[h,f]=(0,o.useState)("");async function m(){try{let e=await fetch("/api/leagues");if(!e.ok)throw Error("Failed to fetch leagues");let r=await e.json();c(r.leagues||[])}catch(e){f("Failed to load leagues")}finally{g(!1)}}async function x(e,r){try{let t=await fetch("/api/leagues/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({leagueId:e,divisionLevel:r})}),i=t.headers.get("content-type");if(!t.ok)if(i&&-1!==i.indexOf("application/json")){let e=await t.json();throw Error(e.error||"Failed to register")}else throw console.error("Server returned non-JSON response:",t.status,t.statusText),Error("Server error: ".concat(t.status," ").concat(t.statusText));await t.json(),await m(),alert("Successfully registered for the league!")}catch(e){console.error("Registration error:",e),alert(e.message||"Failed to register for league")}}async function y(e){if(confirm("Are you sure you want to cancel your registration?"))try{if(!(await fetch("/api/leagues/".concat(e,"/registration"),{method:"DELETE"})).ok)throw Error("Failed to cancel registration");await m(),alert("Registration cancelled successfully")}catch(e){alert("Failed to cancel registration")}}(0,o.useEffect)(()=>{"unauthenticated"===r?t.push("/login"):"authenticated"===r&&m()},[r,t]);let p=e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),b=e=>{let r=new Date,t=new Date(e.registrationOpens),i=new Date(e.registrationCloses);return r>=t&&r<=i};return"loading"===r||u?(0,i.jsx)("div",{style:{minHeight:"80vh",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,i.jsx)("div",{style:{color:"white"},children:"Loading leagues..."})}):(0,i.jsxs)("div",{style:{minHeight:"calc(100vh - 64px)"},children:[(0,i.jsx)("div",{style:{backgroundColor:"white",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1)"},children:(0,i.jsx)("div",{style:{maxWidth:"80rem",margin:"0 auto",padding:"1.5rem 1rem"},children:(0,i.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:(0,i.jsxs)("div",{children:[(0,i.jsx)("nav",{style:{display:"flex"},children:(0,i.jsxs)("ol",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,i.jsxs)("li",{children:[(0,i.jsx)(l(),{href:"/dashboard",style:{color:"#6b7280",textDecoration:"none",fontSize:"0.875rem"},children:"Dashboard"}),(0,i.jsx)("span",{style:{margin:"0 0.5rem",color:"#9ca3af"},children:"/"})]}),(0,i.jsx)("li",{children:(0,i.jsx)("span",{style:{color:"#111827",fontWeight:"500",fontSize:"0.875rem"},children:"Leagues"})})]})}),(0,i.jsx)("h1",{style:{marginTop:"0.5rem",fontSize:"1.5rem",fontWeight:"bold",color:"#111827",fontFamily:"var(--font-playfair), Georgia, serif"},children:"Available Leagues"})]})})})}),(0,i.jsxs)("div",{style:{maxWidth:"80rem",margin:"0 auto",padding:"2rem 1rem"},children:[h&&(0,i.jsx)("div",{style:{marginBottom:"1rem",padding:"1rem",backgroundColor:"#fef2f2",border:"1px solid #fecaca",color:"#991b1b"},children:h}),0===a.length?(0,i.jsx)("div",{style:{backgroundColor:"white",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1)",padding:"1.5rem",textAlign:"center"},children:(0,i.jsx)("p",{style:{color:"#6b7280"},children:"No leagues are currently available."})}):(0,i.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(350px, 1fr))",gap:"1.5rem"},children:a.map(e=>{var r,t;return(0,i.jsx)("div",{style:{backgroundColor:"white",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1)",overflow:"hidden"},children:(0,i.jsxs)("div",{style:{padding:"1.5rem"},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"1rem"},children:[(0,i.jsx)("h3",{style:{fontSize:"1.125rem",fontWeight:"500",color:"#111827",fontFamily:"var(--font-playfair), Georgia, serif"},children:e.name}),(0,i.jsx)("span",{style:{display:"inline-flex",alignItems:"center",padding:"0.125rem 0.625rem",fontSize:"0.75rem",fontWeight:"500",backgroundColor:e.userRegistration?"#d1fae5":b(e)?"#fef3c7":"#f3f4f6",color:e.userRegistration?"#065f46":b(e)?"#92400e":"#374151"},children:e.userRegistration?"Registered":b(e)?"Registration Open":"Registration Closed"})]}),(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem",fontSize:"0.875rem",color:"#6b7280",marginBottom:"1rem"},children:[(0,i.jsxs)("div",{style:{display:"flex",gap:"1rem"},children:[(0,i.jsx)("span",{style:{padding:"0.25rem 0.5rem",fontSize:"0.75rem",fontWeight:"500",backgroundColor:"#f3f4f6",color:"#374151"},children:(0,d.q)(e.gameType)}),(0,i.jsxs)("span",{style:{padding:"0.25rem 0.5rem",fontSize:"0.75rem",fontWeight:"500",backgroundColor:"#ede9fe",color:"#5b21b6"},children:["Ranked by ","BY_POINTS"===e.rankingMethod?"Points":"Wins"]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"Dates:"})," ",p(e.startDate)," - ",p(e.endDate)]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"Registration:"})," ",p(e.registrationOpens)," - ",p(e.registrationCloses)]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"Players registered:"})," ",e._count.registrations]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"League Fee:"})," "," ",e.isFree?(0,i.jsx)("span",{style:{color:"#10b981",fontWeight:"600"},children:"FREE"}):(0,i.jsxs)("span",{style:{fontWeight:"600"},children:["$",(null==(r=e.leagueFee)?void 0:r.toFixed(2))||"0.00"]})]}),(null==(t=e.userRegistration)?void 0:t.division)&&(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"Your Division:"})," ",e.userRegistration.division.name]})]}),e.userRegistration?(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[(0,i.jsx)("div",{style:{fontSize:"0.875rem",color:"#059669",fontWeight:"500"},children:"âœ“ You are registered for this league"}),(0,i.jsx)("button",{onClick:()=>y(e.id),style:{width:"100%",padding:"0.5rem 1rem",fontSize:"0.875rem",fontWeight:"500",color:"#991b1b",backgroundColor:"#fef2f2",border:"1px solid #fecaca",cursor:"pointer",transition:"all 0.2s"},onMouseOver:e=>{e.currentTarget.style.backgroundColor="#fee2e2"},onMouseOut:e=>{e.currentTarget.style.backgroundColor="#fef2f2"},children:"Cancel Registration"})]}):b(e)?(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[(0,i.jsx)("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",color:"#374151"},children:"Select your skill level:"}),(0,i.jsxs)("select",{id:"division-".concat(e.id),style:{display:"block",width:"100%",padding:"0.5rem",border:"1px solid #d1d5db",fontSize:"0.875rem",outline:"none"},defaultValue:"",onFocus:e=>{e.currentTarget.style.borderColor="#111827",e.currentTarget.style.boxShadow="0 0 0 1px #111827"},onBlur:e=>{e.currentTarget.style.borderColor="#d1d5db",e.currentTarget.style.boxShadow="none"},children:[(0,i.jsx)("option",{value:"",disabled:!0,children:"Choose division"}),e.divisions.map(e=>(0,i.jsx)("option",{value:e.level,children:e.name},e.id))]}),(0,i.jsx)("button",{onClick:()=>{let r=document.getElementById("division-".concat(e.id));r.value?x(e.id,r.value):alert("Please select a division")},style:{width:"100%",padding:"0.5rem 1rem",fontSize:"0.875rem",fontWeight:"500",color:"white",backgroundColor:"#1f2937",border:"1px solid #1f2937",cursor:"pointer",transition:"all 0.2s"},onMouseOver:e=>{e.currentTarget.style.backgroundColor="#111827"},onMouseOut:e=>{e.currentTarget.style.backgroundColor="#1f2937"},children:"Register for League"})]}):(0,i.jsx)("div",{style:{fontSize:"0.875rem",color:"#6b7280"},children:"Registration is currently closed"}),(0,i.jsx)(l(),{href:"/standings?leagueId=".concat(e.id),style:{display:"block",width:"100%",marginTop:"1rem",padding:"0.5rem 1rem",fontSize:"0.875rem",fontWeight:"500",color:"#1f2937",backgroundColor:"white",border:"1px solid #d1d5db",textAlign:"center",textDecoration:"none",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#f3f4f6",e.currentTarget.style.borderColor="#9ca3af"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="white",e.currentTarget.style.borderColor="#d1d5db"},children:"View Standings"})]})},e.id)})})]})]})}},5016:(e,r,t)=>{"use strict";function i(e){switch(e){case"SINGLES":return"Singles";case"DOUBLES":return"Doubles";case"CUTTHROAT":return"Cut-Throat";default:return e}}t.d(r,{q:()=>i})},9355:(e,r,t)=>{Promise.resolve().then(t.bind(t,1566))}},e=>{e.O(0,[2619,6489,8441,1255,7358],()=>e(e.s=9355)),_N_E=e.O()}]);